import time

import scapy.all as scapy #pip3 install scapy
import time
#construct the ARP echo request packets

#Ether Header
ether_req = scapy.Ether()

#Broadcast MAC Address
ether_req.dst = "ff:ff:ff:ff:ff:ff"

#ARP Header
arp_req = scapy.ARP()

# set the ip address or the LAN subnet to be Scanned
arp_req.pdst = "192.168.239.0/24"

#Complete ARP Packet
ARP_Request_PKT = ether_req/arp_req

print("ARP Echo Request Packet Construction Complete")

#Scanning the LAN
T1_SCAN_START = time.time()
print("SCAN started")
ans = scapy.srp(ARP_Request_PKT,timeout=1,retry=1,verbose=False,iface="eth0",inter=0.005)[0]

T2_SCAN_COMPLETE = time.time()
print("Time needed for the SCAN",T2_SCAN_COMPLETE - T1_SCAN_START,"seconds")

#get the live hosts
for snd,rcv in ans:
    print("Live Host",rcv[0].psrc)